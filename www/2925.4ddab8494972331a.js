"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2925],{2925:(k,m,a)=>{a.r(m),a.d(m,{CompraPageModule:()=>S});var p=a(177),d=a(4341),s=a(1075),g=a(2559),h=a(467),u=a(8244),C=a(7464),o=a(4438),F=a(6612),f=a(3569);function P(t,r){if(1&t&&(o.j41(0,"ion-item")(1,"ion-label")(2,"h2"),o.EFF(3),o.k0s(),o.j41(4,"p"),o.EFF(5),o.nI1(6,"currency"),o.k0s(),o.j41(7,"p"),o.EFF(8),o.k0s()()()),2&t){const n=r.$implicit;o.R7$(3),o.JRh(n.nombre),o.R7$(2),o.SpI("Precio: ",o.bMT(6,3,n.precio),""),o.R7$(3),o.SpI("Cantidad: ",n.cantidad,"")}}function v(t,r){if(1&t&&(o.j41(0,"div")(1,"h2"),o.EFF(2,"Tu Ubicaci\xf3n Actual"),o.k0s(),o.j41(3,"p"),o.EFF(4),o.k0s(),o.j41(5,"p"),o.EFF(6),o.k0s(),o.nrm(7,"div",5),o.k0s()),2&t){const n=o.XpG();o.R7$(4),o.SpI("Latitud: ",n.userLocation.lat,""),o.R7$(2),o.SpI("Longitud: ",n.userLocation.lng,"")}}function b(t,r){1&t&&(o.j41(0,"div")(1,"p"),o.EFF(2,"Obteniendo ubicaci\xf3n..."),o.k0s()())}const{Geolocation:M}=C.ry,L=[{path:"",component:(()=>{var t;class r{constructor(i,e){this.carritoService=i,this.compraRegistroService=e,this.productosSeleccionados=[],this.userLocation={lat:0,lng:0},this.nombre="",this.apellido=""}ngOnInit(){this.productosSeleccionados=this.carritoService.obtenerCarrito()}getUserLocation(){var i=this;return(0,h.A)(function*(){try{const e=yield M.getCurrentPosition();i.userLocation={lat:e.coords.latitude,lng:e.coords.longitude},console.log("User Location:",i.userLocation),i.initializeMap()}catch(e){console.error("Error obteniendo ubicaci\xf3n:",e)}})()}initializeMap(){this.map||(this.map=u.map("map").setView([this.userLocation.lat,this.userLocation.lng],13),u.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.map),u.marker([this.userLocation.lat,this.userLocation.lng]).addTo(this.map).bindPopup("Tu ubicaci\xf3n actual").openPopup())}realizarPedido(){const i=this.productosSeleccionados.reduce((c,l)=>c+parseFloat(l.precio)*l.cantidad,0),e={nombre:this.nombre,apellido:this.apellido,lat:this.userLocation.lat.toString(),lng:this.userLocation.lng.toString(),total:i.toString()};this.compraRegistroService.addCompra(e).then(()=>{console.log("Pedido realizado:",e)})}}return(t=r).\u0275fac=function(i){return new(i||t)(o.rXU(F.a),o.rXU(f.H))},t.\u0275cmp=o.VBU({type:t,selectors:[["app-compra"]],decls:21,vars:5,consts:[[4,"ngFor","ngForOf"],["position","stacked"],[3,"ngModelChange","ngModel"],["expand","block",3,"click"],[4,"ngIf"],["id","map",2,"height","300px"]],template:function(i,e){1&i&&(o.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),o.EFF(3,"Compra"),o.k0s()()(),o.j41(4,"ion-content")(5,"ion-list"),o.DNE(6,P,9,5,"ion-item",0),o.k0s(),o.j41(7,"ion-item")(8,"ion-label",1),o.EFF(9,"Nombre"),o.k0s(),o.j41(10,"ion-input",2),o.mxI("ngModelChange",function(l){return o.DH7(e.nombre,l)||(e.nombre=l),l}),o.k0s()(),o.j41(11,"ion-item")(12,"ion-label",1),o.EFF(13,"Apellido"),o.k0s(),o.j41(14,"ion-input",2),o.mxI("ngModelChange",function(l){return o.DH7(e.apellido,l)||(e.apellido=l),l}),o.k0s()(),o.j41(15,"ion-button",3),o.bIt("click",function(){return e.getUserLocation()}),o.EFF(16,"Capturar Ubicaci\xf3n"),o.k0s(),o.DNE(17,v,8,2,"div",4)(18,b,3,0,"div",4),o.j41(19,"ion-button",3),o.bIt("click",function(){return e.realizarPedido()}),o.EFF(20,"Pedir"),o.k0s()()),2&i&&(o.R7$(6),o.Y8G("ngForOf",e.productosSeleccionados),o.R7$(4),o.R50("ngModel",e.nombre),o.R7$(4),o.R50("ngModel",e.apellido),o.R7$(3),o.Y8G("ngIf",e.userLocation),o.R7$(),o.Y8G("ngIf",!e.userLocation))},dependencies:[p.Sq,p.bT,d.BC,d.vS,s.Jm,s.W9,s.eU,s.$w,s.uz,s.he,s.nf,s.BC,s.ai,s.Gw,p.oe]}),r})()}];let R=(()=>{var t;class r{}return(t=r).\u0275fac=function(i){return new(i||t)},t.\u0275mod=o.$C({type:t}),t.\u0275inj=o.G2t({imports:[g.iI.forChild(L),g.iI]}),r})(),S=(()=>{var t;class r{}return(t=r).\u0275fac=function(i){return new(i||t)},t.\u0275mod=o.$C({type:t}),t.\u0275inj=o.G2t({imports:[p.MD,d.YN,s.bv,R]}),r})()}}]);